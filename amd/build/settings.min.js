/**
 * @module assignsubmission_onlyoffice/settings
 * @copyright  2025 Ascensio System SIA <integration@onlyoffice.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 **/
define("assignsubmission_onlyoffice/settings",["core/notification","assignsubmission_onlyoffice/repository"],(function(Notification,repository){let docEditor=null;const openEditor=function(contextid,key,format,templatetype){closeEditor(),repository.buildSettingsEditorConfig(contextid,key,format,templatetype).then((config=>{const editorConfig=JSON.parse(config);docEditor=new DocsAPI.DocEditor("onlyoffice-editor",editorConfig)})).catch((error=>{console.error("Error building editor config:",error)}))},closeEditor=function(){docEditor&&(docEditor.destroyEditor(),docEditor=null)},generateUniqueId=()=>Math.floor(Date.now()/1e3).toString(16)+Math.floor(1e3*Math.random()).toString(16);return{init:function(contextid){if("undefined"==typeof DocsAPI&&null===DocsAPI)return void Notification.error("Document Server is not defined!");const selectformat=document.querySelector('select[id="id_assignsubmission_onlyoffice_format"]'),selecttemplatetype=document.querySelector('select[id="id_assignsubmission_onlyoffice_template_type"]'),enabletoggleelement=document.querySelector('input[id="id_assignsubmission_onlyoffice_enabled"]'),templatekeyelement=document.querySelector("input[name='assignsubmission_onlyoffice_tmplkey']");if(!selectformat||!selecttemplatetype)return void enabletoggleelement.addEventListener("change",(function(e){const hassubmissionalert=document.getElementById("assignsubmission_onlyoffice-hassubmissionalert");e.currentTarget.checked?hassubmissionalert.classList.remove("hidden"):hassubmissionalert.classList.add("hidden")}));const originalformat=selectformat.value,originaltemplatekey=templatekeyelement.value,originaltemplatetype=selecttemplatetype.value;enabletoggleelement.checked&&"custom"===selecttemplatetype.value&&"upload"!==selectformat.value&&openEditor(contextid,templatekeyelement.value,selectformat.value,selecttemplatetype.value),enabletoggleelement.addEventListener("change",(function(e){e.currentTarget.checked&&"upload"!==selectformat.value&&"custom"===selecttemplatetype.value&&null===docEditor&&openEditor(contextid,templatekeyelement.value,selectformat.value,selecttemplatetype.value)})),selectformat.addEventListener("change",(async function(e){e.currentTarget.value===originalformat&&selecttemplatetype.value===originaltemplatetype?templatekeyelement.value=originaltemplatekey:templatekeyelement.value=generateUniqueId(),"upload"!==e.currentTarget.value&&"custom"===selecttemplatetype.value?openEditor(contextid,templatekeyelement.value,selectformat.value,selecttemplatetype.value):("upload"===e.currentTarget.value&&(selecttemplatetype.value="custom",selecttemplatetype.dispatchEvent(new Event("change"))),closeEditor())})),selecttemplatetype.addEventListener("change",(function(e){e.currentTarget.value===originalformat&&selecttemplatetype.value===originaltemplatetype?templatekeyelement.value=originaltemplatekey:templatekeyelement.value=generateUniqueId(),"custom"===e.currentTarget.value&&"upload"!==selectformat.value?openEditor(contextid,templatekeyelement.value,selectformat.value,e.currentTarget.value):closeEditor()}))}}}));

//# sourceMappingURL=settings.min.js.map